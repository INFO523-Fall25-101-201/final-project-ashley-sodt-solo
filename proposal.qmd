---
title: "Clustering Movement Patterns in Equine Exercise Sessions Using Anomaly Detection"
subtitle: "Proposal"
author: 
  - name: Ashley Sodt
    affiliations:
      - name: "Applied Math PhD Student, University of Arizona"

One sentence description: 
"My goal is to use unsupervised learning techniques to cluster EquiPro sessions and detect
anomalies that may reflect behavioral irregularities, equipment issues, or potential reinjury."

Paragraph description:
"In this project, I aim to detect abnormal equine exercise sessions by clustering 
movement-based features derived from processed EquiPro accelerometer data. Horses 
at the Al-Marah Equine Center are equipped with 7 accelerometers during exercise 
sessions on a lunge line at walk, trot, and canter. The EquiPro system outputs 
calculated biomechanical metrics such as diagonal advanced placement, stride 
duration, and footfall duration. By modeling typical movement patterns for each 
horse, I plan to identify exercise sessions that deviate significantly from a 
horse’s baseline. Such anomalies may reflect behavioral irregularities, equipment 
malfunction, pain, or potential reinjury. This is important in equine rehabilitation, 
where subtle changes in loading or symmetry can precede clinical signs of injury.

The dataset for this project consists of multiple sessions for three horses: 
Duque (14 sessions), Jackson (6 sessions), and Perseo (5 sessions). The Equipro 
system processes results for each session and outputs a CSV file containing 
stride-level, time-sampled biomechanical variables. For each horse, I will compile 
these sessions into one file with session-level features for analysis. I chose this 
dataset because it is directly relevant to my graduate research and because it is 
well suited for unsupervised analysis. Session-level features will allow me to 
establish per-horse baseline distributions and apply methods such as z-score 
analysis, k-means clustering, and Isolation Forest to quantify deviations. By 
identifying and visualizing sessions with anomalies over time, this project will 
explore whether data-driven monitoring can help track rehabilitation progress and 
highlight sessions that warrant further investigation."

format:
  html:
    code-tools: true
    code-overflow: wrap
    code-line-numbers: true
    embed-resources: true
editor: visual
code-annotations: hover
execute:
  warning: false
jupyter: python3
---

```{python}
#| label: load-pkgs
#| message: false


import numpy as np
```

## Dataset

```{python}
#| label: load-dataset
#| message: false

import pandas as pd

df_duque = pd.read_csv("data/Horses/Duque/20240626T082743-Duque-results.csv")
df_duque.shape
```

## Dataset description:

The primary dataset consists of EquiPro csv result files collected from horses exercised at 
the Al-Marah Equine Center. The EquiPro system outputs a CSV file for each session containing 
biomechanical variables like diagonal advanced placement and duration of footfalls. 
The file loaded above for Duque contains {{ df_duque.shape[0] }} rows and {{ df_duque.shape[1] }} columns.

For this project, I am using three horses with multiple sessions: 
Duque (14 sessions), Jackson (6 sessions), and Perseo (5 sessions). These sessions allow 
analysis within each horse over time. I chose this dataset because (1) it is directly 
relevant to my research group’s goal of developing tools for equine rehabilitation 
monitoring, and (2) the repeated-session structure makes it well suited for unsupervised 
learning approaches.

## Questions

Which exercise sessions significantly deviate from each horse’s baseline distribution, 
and which biomechanical variables contribute most strongly to those deviations?

How do different unsupervised anomaly-detection methods (z-score thresholding, k-means cluster distance, 
and Isolation Forest) compare in identifying abnormal sessions, and to what extent do they 
agree or disagree on which sessions are flagged as anomalous?

## Analysis plan

For each exercise session, I will load the corresponding EquiPro CSV file and extract 
biomechanical variables relevant to symmetry, gait, and stride mechanics. To create 
session-level features, I will summarize each variable using statistics like mean, 
standard deviation, interquartile range, etc. These engineered features will form 
a feature matrix for each horse where each row is a session and each column is a 
biomechanical descriptor.

I will then model each horse's baseline movement patterns. I will standardize all 
features within each horse by converting them to z-scores in order to remove scale 
differences. This will provide a clear reference point. Features consistently close 
to zero after standardization indicate typical behavior, but large positive or negative 
values indicate potential deviations. These standardized distributions form the baseline 
against which the anomaly-detection methods will evaluate whether any given session 
departs significantly from a horse’s typical movement pattern.

After establishing the baselines for each horse using z-scores, I will apply three 
unsupervised anomaly-detection methods to identify sessions that deviate from typical 
movement. Z-score analysis will allow me to flag sessions where specific features 
are unusually high or low relative to baseline distribution. K-means clustering will 
identify anomalies based on their distance from cluster centers in the multivariate 
feature space. Isolation Forest will give a measure of how isolated a session is from 
the rest. Each method will produce a numerical anomaly score and a corresponding label 
indicating whether the session is considered abnormal.

I will then compare the results between the three methods. I will look for overlap 
between flagged sessions, sessions consistently identified as outliers, and note where 
the methods differ. I will also interpret the identified anomalies as they relate to 
biomechanical variables. I will inspect which specific features contribute most strongly 
to deviations from baseline. This could give insight as to possible explanations for 
deviations: behavioral irregularities, equipment malfunction, pain, or potential reinjury.

No external datasets will be merged.
